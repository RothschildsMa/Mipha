<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<link rel="stylesheet" type="text/css" href="/employInformationDisplay.css">
	<title>勤怠管理システム</title>
</head>



<body>
	<script src="../../static/js/deleteEmployee.js"></script>
	<div class="header">
		<h1 class="header_css">株式会社ＸＸＸ</h1>    
		<button class="logout_css">ログアウト</button>
	</div>
	<div class="p_css">
		<p class="p1">社員情報一覧</p>
	</div>
	
	<form th:action="@{/emp/add}">
		<button id="loginBtn" class="loginBtu_css">登録</button>
	</form>

	<form th:action="@{/employee/search}" th:object="${updateForm}" th:method="post">
		<div class="firstSelectRow_css">
			<label for="member-id" class="label1">社員ID:</label>
			<form  method="get"> 
			<input type="text" th:field="*{employeeId}" id="employeeId" name="member-id" class="input1"><br><br>
			</form>
			<label for="department" class="label2">所属部門:</label>
			<select id="department" name="department" class="select1">
				<option value="004">第一開発部</option>
				<option value="005">第ニ開発部</option>
				<option value="003">営業部</option>
			</select><br><br>
			
			<button id="searchBtn" type="submit"  class="searchBtu_css">検索</button>
			
		</div>
		<div class="twoSelectRow_css">
			<label for="start-date" class="label3">入社年月日:</label>
			<input type="date" id="start-date" name="start-date"class="timeStart"><br><br>
			<p class="p2">~</p>
			<input type="date" id="end-date" name="end-date"class="timeEnd"><br><br>
		</div>
	</form>
		
	
	<form th:action="@{/deleteEmployees}" th:method="post" id="deleteForm">
		

	
	<div class="table-container" th:if="${employeeList}">
	<table>
		<tr class="trFirst_css">
			<th>選択</th>
			<th>社員ID</th>
			<th>入社年月日</th>
			<th>氏名</th>
			<th>カタカナ</th>
			<th>性別</th>
			<th>年齢</th>
			<th>所属</th>
			<th>電話番号</th>
			<th>メールアドレス</th>
		</tr>
		
		
		<tr th:each="employee, status : ${employeeList}" th:object="${employee}">
             <td><input type="checkbox" th:checked="${employee.checked}" 
             th:name="selectedEmployees" 
             th:value="${employee.id}" 
             th:id="${'selectedEmployees_' + status.index + '_checked'}"></td>
             <td><a th:href="@{/emp/{id}/update(id=*{employeeId})}" th:text="*{employeeId}"></a></td>
             <td th:text="${#dates.format(employee.joinDate, 'yyyy/MM/dd')}"></td>
             <td th:text="*{employeeName}"></td>
             <td th:text="*{employeeNameKana}"></td>
             <td th:text="*{employeeGenderId}"></td>
             <td th:text="*{employeeAge}"></td>
             <td th:text="*{employeeDepatmentId}"></td>
             <td th:text="*{employeePhoneNumber}"></td>
             <td th:text="*{employeeMail}"></td>

           </tr>
	</table>

	<script>
		function toggleButton() {
		    var checkboxes = document.getElementsByName("selectedEmployees");
		    var deleteButton = document.getElementById("deleteButton");
		    var checkedCount = 0;
		    for (var i = 0; i < checkboxes.length; i++) {
		      if (checkboxes[i].checked) {
		        checkedCount++;
		      }
		    }
		    if (checkedCount > 0) {
		      deleteButton.removeAttribute("disabled");
		    } else {
		      deleteButton.setAttribute("disabled", "");
		    }
		  }
		
		  // チェックボックスの状態が変化したときにtoggleButton関数を呼び出す
		  var checkboxes = document.getElementsByName("selectedEmployees");
		  for (var i = 0; i < checkboxes.length; i++) {
		    checkboxes[i].addEventListener("change", toggleButton);
		  }
		
		  var deleteButton = document.getElementById("deleteButton");
		
		  // ボタンをクリックしたときにチェックが0個ならエラーメッセージを表示する
		  deleteButton.addEventListener("click", function() {
		    var checkedCount = 0;
		    for (var i = 0; i < checkboxes.length; i++) {
		      if (checkboxes[i].checked) {
		        checkedCount++;
		      }
		    }
		    if (checkedCount == 0) {
		      alert("削除する社員を選択してください。");
		    }
		  });
		/*// チェックボックスの状態を取得し、ボタンの活性化を制御する関数
		 function toggleButton() {
         var checkboxes = document.getElementsByName("selectedEmployees");
         var deleteButton = document.getElementById("deleteButton");

         var checked = false;
         for (var i = 0; i < checkboxes.length; i++) {
                if (checkboxes[i].checked) {
                    checked = true;
                    break;
                }
            }

        if (checked) {
                deleteButton.removeAttribute("disabled");
            } else {
                deleteButton.setAttribute("disabled", "true");
            }
      }

    	// チェックボックスの状態が変化したときにtoggleButton関数を呼び出す
        var checkboxes = document.getElementsByName("selectedEmployees");
        for (var i = 0; i < checkboxes.length; i++) {
            checkboxes[i].addEventListener("change", toggleButton);
        }
        */
	</script>
		<button type="submit" id="deleteButton" class="btn btn-danger delete_css" disabled>削除</button>
	
	</div>

		
	</form>
		
</body>
</html>
